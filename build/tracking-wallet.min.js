/*! tracking-wallet - v3.3.0 - 2019-06-21 */"use strict";!function(a){var b=null,c=function(a){this.levelLogger=a};c.prototype.debug=function(b){this.levelLogger>=3&&a&&a.console&&a.console.debug&&a.console.debug(b)},c.prototype.info=function(b){this.levelLogger>=2&&a&&a.console&&a.console.info&&a.console.info(b)},c.prototype.warn=function(b){this.levelLogger>=1&&a&&a.console&&a.console.warn&&a.console.warn(b)},c.prototype.error=function(b){this.levelLogger>=0&&a&&a.console&&a.console.error&&a.console.error(b)};var d=function(){};d.getId=function(){function a(){return Math.random().toString(16).slice(-4)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()};var e=function(){};e.get=function(b){if(document.cookie.length>0){var c=document.cookie.indexOf(b+"=");if(-1!==c){c=c+b.length+1;var d=document.cookie.indexOf(";",c);return-1===d&&(d=document.cookie.length),a.unescape(document.cookie.substring(c,d))}}return null},e.set=function(a,b,c,d){var e,f="";if(c){var g=new Date;g.setTime(g.getTime()+24*c*60*60*1e3),e="; expires="+g.toGMTString()}else e="";d&&(f=";domain="+d),document.cookie=a+"="+b+e+"; path=/"+f};var f={prefixNameTrakingData:"data-tw-",nameTrackingEventData:"data-tw-event",prefixNameTrackingOwnerDomain:"tw-owner-domain",preTextLogger:"TR-W",pageViewEvent:"Page view",clickEvent:"click",submitEvent:"submit",defaultTimeout:300,cookieFirst:"CW-FirstTime",cookieLastPartner:"last-partner",sendPageView:"send-page-view",cookieExpiration:1825,disabledTrackingCookieName:"ichbineincover"},g={},h=null,i={},j=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},k=function(a){if(a!==f.prefixNameTrakingData+"event"){var b=a.replace(f.prefixNameTrakingData,"");return b=b.replace("-"," "),j(b)}return a.replace(f.prefixNameTrakingData,"")},l=function(a){var b,c,d=a[0].attributes,e=null,g={};for(c=0,b=d.length;c<b;c++)e=d[c],0===e.name.indexOf(f.prefixNameTrakingData)&&(g[k(e.name)]=e.value);return g},m=function(a,b){a[0].click(),setTimeout(function(){a.on("click",b)},200)},n=function(a){if(a.attr("id"))return a.attr("id");var b=d.getId();return a.attr("id","tw-"+b),"tw-"+b},o=function(b,c){if("a"===b.prop("tagName").toLowerCase())a.analytics.trackLink(b,j(f.clickEvent),c),h.debug("Bind event click in "+n(b));else{var d=function(e){e.preventDefault(),b.unbind("click",d),setTimeout(function(){m(b,d)},f.defaultTimeout),a.analytics.track(j(f.clickEvent),c)};b.on("click",d)}},p=function(b){var c={};return a.$.each(b.find("input, select"),function(b,d){a.$(d).data("tw-name")&&(c[a.$(d).data("tw-name")]=a.$(d).val())}),c},q=function(b,c){"form"===b.prop("tagName").toLowerCase()?a.analytics.trackForm(b,j(f.submitEvent),function(){var d=p(b);return a.$.extend({},c,d)}):console.error("submit event if only allowed in form tags")},r=function(b){var c=l(b);if(c=a.$.extend({},g,c),c.event){var d=c.event;switch(delete c.event,d){case f.clickEvent:o(b,c);break;case f.submitEvent:q(b,c);break;default:console.warn("Event not found! ("+d+")")}}else h.error("Element has not defined event attribute")},s=function(){var b,c=null,d=a.$("["+f.nameTrackingEventData+"]");if(d&&d.length>0)for(b=d.length,c=0;c<b;c++)r(a.$(d[c]))},t=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+b+"=([^&#]*)",d=new RegExp(c),e=d.exec(a);return null===e||e&&"string"!=typeof e[1]&&e[1].length?"":decodeURIComponent(e[1]).replace(/\+/g," ")},u=function(a,b){return a&&a.indexOf(b)>=0},v=function(){var a=document.referrer;return!!(u(a,"google")||u(a,"bing")||u(a,"yahoo"))},w=function(){var a=document.referrer;return!!(u(a,"facebook")||u(a,"twitter")||u(a,"plus.google")||u(a,"linkedin")||u(a,"pinterest")||u(a,"instagram"))},x=function(){var a=document.referrer;return!(w()||v()||!a)},y=function(){return!x()},z=function(){var a=t(document.URL,"utm_medium");return a||(w()?"social":v()?"seo":x()?"referral":y()?"$direct":void 0)},A=function(a){var b=a.split("_");return b.length>1?b[0].toUpperCase()+" "+j(b[1]):j(a)},B=function(){if(void 0!==a.analytics.user&&null!==a.analytics.user){var b=a.analytics.user();if(void 0!==b.traits&&null!==b.traits){for(var c=b.traits(),d=["UTM Source","UTM Medium","UTM Campaign","UTM Content","UTM Term","Touch Source","Partner"],e=0;e<d.length;++e){var f="Last "+d[e];void 0!==c[f]&&delete c[f]}b.traits(c)}}},C=function(a,b){return b[a+"Touch Source"]=z(),b[a+"Partner"]=e.get(f.cookieLastPartner)||"CoverWallet",b},D=function(){if(null!==b)return b;B();var a,c="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),d="",e="Last ",f={};for(a=0;a<c.length;++a)d=t(document.URL,c[a]),d.length&&(f[e+A(c[a])]=d);return C(e,f)},E=function(){return C("First ",{})},F=function(){var b={};if(!e.get(f.cookieFirst)){b=a.$.extend(b,E());var c=a.location.host.split("."),d=c.length>2?c.slice(-2).join("."):a.location.host;e.set(f.cookieFirst,!0,365,d)}h.debug("Obtaining params last");var g=t(document.URL,"gclid");g&&(b.gclid=g),void 0!==a.analytics.user&&void 0!==a.analytics.user().traits?(b=a.$.extend(a.analytics.user().traits(),b,D()),a.analytics.identify(a.analytics.user().id(),b)):(b=a.$.extend(b,D()),a.analytics.identify(null,b))},G=function(){return!(!a.dataLayer||!a.dataLayer.push)},H=function(b){a.analytics.page(b),i.skipPageViewEvents||a.analytics.track(f.pageViewEvent,b)},I=function(b,c){if(Q()){var d=a.$.extend({},g,c);b===f.pageViewEvent?H(d):a.analytics.track(b,d),G()&&a.dataLayer.push(Object.assign({},{event:b},c))}},J=function(){h.debug("Sending page view event");var b=a.$("body"),c=l(b);g=c,I(f.pageViewEvent,c)},K=function(){h.debug("Starting Post Init Process");try{i.calcLastAttrs&&(!document.referrer||document.referrer.indexOf(i.domainName)<0)&&F(),i.hasOwnProperty("sendPageView")&&!0!==i.sendPageView||J(),s()}catch(a){console.error(a)}},L=function(b){if(!i.skipInitIdentifying){h.debug("Starting tracking");try{var c=null,d=null;void 0!==b&&void 0!==b.userId&&(c=b.userId,d=b.traits),a.analytics.identify(c,d,{},K)}catch(e){console.error(e)}}},M=function(b){i=b||{};var d=0;if(void 0===a.analytics)throw new Error("window.analytics not load");"production"!==(a.$("body").data("env")?a.$("body").data("env").toLowerCase():"production")&&(d=3),i.hasOwnProperty("domainName")&&null!==i.domainName||(i.domainName=a.location.host.match(/\.?([^.]+)\.[^.]+.?$/)[1]),i.hasOwnProperty("sendPageView")&&null!==i.sendPageView||(i.sendPageView=!0),i.hasOwnProperty("calcLastAttrs")||(i.calcLastAttrs=!0),h=new c(d),d>=3&&a.analytics.debug(),analytics.ready(function(){a.mixpanel.set_config({cookie_expiration:f.cookieExpiration})}),Q()&&L(b)},N=function(b,c,d,e){Q()&&(h.debug("Identifying user with id "+b),a.analytics.identify(b.toLowerCase(),c,d,e))},O=function(b){Q()&&a.analytics.alias(b)},P=function(){if(a.mixpanel&&a.mixpanel.get_distinct_id)return a.mixpanel.get_distinct_id()},Q=function(){var a=e.get(f.disabledTrackingCookieName);return i.trackAgentsOn||null===a||void 0===a},R=function(b){Q()&&a.analytics&&a.mixpanel&&a.mixpanel.time_event&&a.analytics.ready(function(){a.mixpanel.time_event(b)})},S=function(){b=D()};a.trackingWallet={init:M,track:I,extractDataForm:p,identify:N,preserveUTMTags:S,alias:O,getUserId:P,timeEvent:R}}(window);