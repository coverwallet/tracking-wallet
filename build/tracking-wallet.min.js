/*! tracking-wallet - v0.0.1 - 2015-11-25 */"use strict";!function(a,b){var c=function(a){this.levelLogger=a};c.prototype.debug=function(b){this.levelLogger>=3&&a&&a.console&&a.console.debug&&a.console.debug(b)},c.prototype.info=function(b){this.levelLogger>=2&&a&&a.console&&a.console.info&&a.console.info(b)},c.prototype.warn=function(b){this.levelLogger>=1&&a&&a.console&&a.console.warn&&a.console.warn(b)},c.prototype.error=function(b){this.levelLogger>=0&&a&&a.console&&a.console.error&&a.console.error(b)};var d=function(){};d.getId=function(){function a(){return Math.random().toString(16).slice(-4)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()};var e={prefixNameTrakingData:"data-tw-",nameTrackingEventData:"data-tw-event",preTextLogger:"TR-W",pageViewEvent:"Page view",clickEvent:"click",submitEvent:"submit",defaultTimeout:300},f={},g=null,h=function(a){if(a!==e.prefixNameTrakingData+"event"){var b=a.replace(e.prefixNameTrakingData,"");return b=b.replace("-"," "),i(b)}return a.replace(e.prefixNameTrakingData,"")},i=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},j=function(a){var b,c,d=a[0].attributes,f=null,g={};for(c=0,b=d.length;b>c;c++)f=d[c],0===f.name.indexOf(e.prefixNameTrakingData)&&(g[h(f.name)]=f.value);return g},k=function(a,b){a[0].click(),setTimeout(function(){a.on("click",b)},200)},l=function(a){if(a.attr("id"))return a.attr("id");var b=d.getId();return a.attr("id","tw-"+b),"tw-"+b},m=function(b,c){if("a"===b.prop("tagName").toLowerCase())a.mixpanel.track_links("#"+l(b),i(e.clickEvent),c),g.debug("Bind event click in "+l(b));else{var d=function(f){f.preventDefault(),b.unbind("click",d),setTimeout(function(){k(b,d)},e.defaultTimeout),a.mixpanel.track(i(e.clickEvent),c)};b.on("click",d)}},n=function(a){var c={};return b.each(a.find("input, select"),function(a,d){b(d).data("tw-name")&&(c[b(d).data("tw-name")]=b(d).val())}),c},o=function(c,d){"form"===c.prop("tagName").toLowerCase()?a.mixpanel.track_forms("#"+l(c),i(e.submitEvent),function(){var a=n(c);return b.extend({},d,a)}):console.error("submit event if only allowed in form tags")},p=function(a){var c=j(a);if(c=b.extend({},f,c),c.event){var d=c.event;switch(delete c.event,d){case e.clickEvent:m(a,c);break;case e.submitEvent:o(a,c);break;default:console.warn("Event not found! ("+d+")")}}else g.error("Element has not defined event attribute")},q=function(){var a,c=null,d=b("["+e.nameTrackingEventData+"]");if(d&&d.length>0)for(a=d.length,c=0;a>c;c++)p(b(d[c]))},r=function(){g.debug("Sending page view event");var c=b("body"),d=j(c);f=d,a.mixpanel.track(e.pageViewEvent,d)},s=function(){g.debug("Starting tracking");try{r(),q()}catch(a){console.error(a)}},t=function(){if(void 0===b)throw new Error("Jquery not load");if(void 0===a.mixpanel)throw new Error("window.Mixpanel not load");var d=0;b("body").data("env")&&"production"!==b("body").data("env").toLowerCase()&&(d=3),g=new c(d),a.mixpanel.set_config({debug:3===d}),s()},u=function(c,d){var e=b.extend({},f,d);a.mixpanel.track(c,e)};a.trackingWallet={init:t,track:u,extractDataForm:n}}(window,jQuery);